pipeline {
  agent any
  stages {
    stage('build') {
      steps {
        kubeconfig(serverUrl: 'https://192.168.211.203:6443', credentialsId: '1', caCertificate: 'LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJlVENDQVIrZ0F3SUJBZ0lCQURBS0JnZ3Foa2pPUFFRREFqQWtNU0l3SUFZRFZRUUREQmx5YTJVeUxYTmwKY25abGNpMWpZVUF4TmpnMk1ESXhPVEF4TUI0WERUSXpNRFl3TmpBek1qVXdNVm9YRFRNek1EWXdNekF6TWpVdwpNVm93SkRFaU1DQUdBMVVFQXd3WmNtdGxNaTF6WlhKMlpYSXRZMkZBTVRZNE5qQXlNVGt3TVRCWk1CTUdCeXFHClNNNDlBZ0VHQ0NxR1NNNDlBd0VIQTBJQUJKb0VOSlRNZ2c5eDVlNVpERHVqNUpHR2MxQzFHSTI5OUZlSXUwWmYKQTloenN6VWE0ZlNzWFY0YytwaEY3VFU2a0pxZndZa2JyS0p1dmswWjJwNXVySU9qUWpCQU1BNEdBMVVkRHdFQgovd1FFQXdJQ3BEQVBCZ05WSFJNQkFmOEVCVEFEQVFIL01CMEdBMVVkRGdRV0JCUVNNdjM0M0NGWVY1eHVic3AwCng2c3Nmd09ldURBS0JnZ3Foa2pPUFFRREFnTklBREJGQWlBV21VdlgzRlNTdG01TXJkRlo3N3BRbkhyTTRML1QKZEZ6d2tXZ1pkdXlONkFJaEFOZWZyWUplM2JMOEQrRTVQL2tMTTErSDk2OUtKYUdOZm9zbGtNWnpIL2k4Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K') {
          withKubeConfig(caCertificate: 'LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJlVENDQVIrZ0F3SUJBZ0lCQURBS0JnZ3Foa2pPUFFRREFqQWtNU0l3SUFZRFZRUUREQmx5YTJVeUxYTmwKY25abGNpMWpZVUF4TmpnMk1ESXhPVEF4TUI0WERUSXpNRFl3TmpBek1qVXdNVm9YRFRNek1EWXdNekF6TWpVdwpNVm93SkRFaU1DQUdBMVVFQXd3WmNtdGxNaTF6WlhKMlpYSXRZMkZBTVRZNE5qQXlNVGt3TVRCWk1CTUdCeXFHClNNNDlBZ0VHQ0NxR1NNNDlBd0VIQTBJQUJKb0VOSlRNZ2c5eDVlNVpERHVqNUpHR2MxQzFHSTI5OUZlSXUwWmYKQTloenN6VWE0ZlNzWFY0YytwaEY3VFU2a0pxZndZa2JyS0p1dmswWjJwNXVySU9qUWpCQU1BNEdBMVVkRHdFQgovd1FFQXdJQ3BEQVBCZ05WSFJNQkFmOEVCVEFEQVFIL01CMEdBMVVkRGdRV0JCUVNNdjM0M0NGWVY1eHVic3AwCng2c3Nmd09ldURBS0JnZ3Foa2pPUFFRREFnTklBREJGQWlBV21VdlgzRlNTdG01TXJkRlo3N3BRbkhyTTRML1QKZEZ6d2tXZ1pkdXlONkFJaEFOZWZyWUplM2JMOEQrRTVQL2tMTTErSDk2OUtKYUdOZm9zbGtNWnpIL2k4Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K', clusterName: 'default', namespace: 'jenkins-2', serverUrl: 'https://192.168.211.1203:6443') {
            sh \'kubectl apply -f deployment.yaml\'
          }

        }

      }
    }

  }
  environment {
    DEPLOY_GITREPO_USER = 'bashlion'
    DEPLOY_GITREPO_URL = 'https://github.com/bashlion/nv-demo.git'
  }
}
